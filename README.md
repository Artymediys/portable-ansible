# Portable-Ansible
Чтобы собрать образ с **Ansible**, требуется установленный **Docker**.  
Базовый образ - `alt:p10` **(AltLinux 10)**.  

## Содержание образа
Список устанавливаемых пакетов из репозитория `AltLinux 10`:
- `glibc`
- `openssh`
- `python3`
- `python3-module-pip`

Список устанавливаемых пакетов с помощью `pip3`:
- `ansible`
- `jmespath`

Список устанавливаемых пакетов с помощью `ansible-galaxy`:
- `community.general`

## Сборка образа и пуш в registry
В текущем репозитории есть 3 файла:
- `Dockerfile` – код для последующей сборки образа
- `build_and_push.sh` – скрипт сборки и пуша собранного образа в указанный registry
- `entrypoint.sh` – код для проверки варианта запуска контейнера

В начале скрипта `build_and_push.sh` находится секция с переменными,
которые необходимо задать для корректного выполнения скрипта:
- `IMAGE_NAME`
- `REGISTRY_URL`
- `LOGIN`
- `PASSWORD`

Также сборку можно выполнить без пуша в registry с помощью команды `docker build -t ansible-alt10 .`

## Запуск и работа с образом
Образ предполагает два варианта взаимодействия:
- **интерактивно** – после запуска можно будет
свободно выполнять любые команды в среде контейнера
- **автоматически** – сразу выполнить указанную команду

Чтобы запустить контейнер в интерактивном режиме из собранного образа,
надо выполнить следующую команду: `docker run -it --name portable-ansible ansible-alt10`

Также есть вариант запустить контейнер одноразово и с монтированием директории:
`docker run -it --rm -v /path/to/your/local/directory:/path/in/container ansible-alt10`

Чтобы запустить контейнер в автоматическом режиме, надо в конце предыдущего примера добавить
нужную команду и аргументы (если это необходимо):
`docker run -it --rm -v /path/to/your/local/directory:/path/in/container ansible-alt10 ansible-playbook --version`

_P.S. В автоматическом режиме можно обойтись и без флага `-it`, но использование этого флага позволит Докеру создать
интерактивную сессию терминала внутри контейнера, что может быть полезно для повышения читабельности вывода команд._

Выход из интерактивного режима и завершение работы контейнера возможен с помощью сочетания клавиш: `Ctrl + D`